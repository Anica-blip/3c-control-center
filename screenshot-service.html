<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3C Screenshot Service</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #000;
            overflow: hidden;
        }
        
        canvas {
            display: block;
        }
        
        .loading {
            color: white;
            text-align: center;
            font-family: Arial;
            padding: 50px;
        }
    </style>
</head>
<body>
    <div class="loading">Generating screenshot...</div>
    
    <script>
        function generateScreenshot() {
            const urlParams = new URLSearchParams(window.location.search);
            const title = decodeURIComponent(urlParams.get('title') || 'Interactive Content');
            const desc = decodeURIComponent(urlParams.get('desc') || 'Engage with content');
            const type = urlParams.get('type') || 'Quiz';
            const size = urlParams.get('size') || 'instagram-square';
            
            // Size configurations
            const sizes = {
                'instagram-square': { width: 1080, height: 1080 },
                'instagram-story': { width: 1080, height: 1920 },
                'facebook-post': { width: 1200, height: 630 },
                'twitter-post': { width: 1200, height: 675 },
                'linkedin-post': { width: 1200, height: 627 }
            };
            
            const dimensions = sizes[size] || sizes['instagram-square'];
            
            // Create canvas
            const canvas = document.createElement('canvas');
            canvas.width = dimensions.width;
            canvas.height = dimensions.height;
            const ctx = canvas.getContext('2d');
            
            // Theme colors by type
            const themes = {
                'quiz': {
                    gradient: ['#8B5CF6', '#3B82F6'],
                    emoji: 'ðŸ”¥',
                    accent: '#FFD700'
                },
                'game': {
                    gradient: ['#10B981', '#059669'],
                    emoji: 'ðŸŽ®',
                    accent: '#FFD700'
                },
                'puzzle': {
                    gradient: ['#F59E0B', '#D97706'],
                    emoji: 'ðŸ§©',
                    accent: '#FFFFFF'
                },
                'challenge': {
                    gradient: ['#EF4444', '#DC2626'],
                    emoji: 'âš¡',
                    accent: '#FFD700'
                },
                'assessment': {
                    gradient: ['#6366F1', '#4F46E5'],
                    emoji: 'ðŸ“Š',
                    accent: '#FFD700'
                }
            };
            
            const theme = themes[type.toLowerCase()] || themes.quiz;
            
            // Create gradient background
            const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
            gradient.addColorStop(0, theme.gradient[0]);
            gradient.addColorStop(1, theme.gradient[1]);
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Add subtle pattern overlay
            ctx.fillStyle = 'rgba(255, 255, 255, 0.05)';
            for (let i = 0; i < canvas.width; i += 40) {
                for (let j = 0; j < canvas.height; j += 40) {
                    if ((i + j) % 80 === 0) {
                        ctx.fillRect(i, j, 20, 20);
                    }
                }
            }
            
            // Calculate responsive font sizes based on canvas size
            const baseFontSize = Math.min(canvas.width, canvas.height) / 20;
            const titleFontSize = baseFontSize * 1.2;
            const descFontSize = baseFontSize * 0.6;
            const typeFontSize = baseFontSize * 0.5;
            
            // Add main content area with rounded corners
            const contentPadding = canvas.width * 0.08;
            const contentX = contentPadding;
            const contentY = contentPadding;
            const contentWidth = canvas.width - (contentPadding * 2);
            const contentHeight = canvas.height - (contentPadding * 2);
            
            // Add semi-transparent overlay for content area
            ctx.fillStyle = 'rgba(0, 0, 0, 0.2)';
            ctx.fillRect(contentX, contentY, contentWidth, contentHeight);
            
            // Add type badge
            const badgeWidth = contentWidth * 0.3;
            const badgeHeight = titleFontSize * 1.5;
            ctx.fillStyle = theme.accent;
            ctx.fillRect(contentX + 20, contentY + 20, badgeWidth, badgeHeight);
            
            ctx.fillStyle = theme.gradient[0];
            ctx.font = `bold ${typeFontSize}px Arial`;
            ctx.textAlign = 'left';
            ctx.textBaseline = 'middle';
            ctx.fillText(type.toUpperCase(), contentX + 35, contentY + 20 + badgeHeight/2);
            
            // Add emoji
            ctx.font = `${titleFontSize * 1.5}px Arial`;
            ctx.textAlign = 'center';
            ctx.fillStyle = 'white';
            ctx.fillText(theme.emoji, canvas.width/2, contentY + contentHeight * 0.25);
            
            // Add title with text wrapping
            ctx.fillStyle = 'white';
            ctx.font = `bold ${titleFontSize}px Arial`;
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            
            const titleWords = title.split(' ');
            const titleLines = [];
            let currentLine = '';
            const maxTitleWidth = contentWidth * 0.9;
            
            for (const word of titleWords) {
                const testLine = currentLine + word + ' ';
                const metrics = ctx.measureText(testLine);
                
                if (metrics.width > maxTitleWidth && currentLine !== '') {
                    titleLines.push(currentLine.trim());
                    currentLine = word + ' ';
                } else {
                    currentLine = testLine;
                }
            }
            titleLines.push(currentLine.trim());
            
            const titleStartY = contentY + contentHeight * 0.4;
            titleLines.forEach((line, index) => {
                ctx.fillText(line, canvas.width/2, titleStartY + (index * titleFontSize * 1.2));
            });
            
            // Add description
            ctx.font = `${descFontSize}px Arial`;
            ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';
            
            const descWords = desc.split(' ');
            const descLines = [];
            let currentDescLine = '';
            const maxDescWidth = contentWidth * 0.8;
            
            for (const word of descWords) {
                const testLine = currentDescLine + word + ' ';
                const metrics = ctx.measureText(testLine);
                
                if (metrics.width > maxDescWidth && currentDescLine !== '') {
                    descLines.push(currentDescLine.trim());
                    currentDescLine = word + ' ';
                } else {
                    currentDescLine = testLine;
                }
            }
            descLines.push(currentDescLine.trim());
            
            // Limit description to 3 lines
            const limitedDescLines = descLines.slice(0, 3);
            if (descLines.length > 3) {
                limitedDescLines[2] = limitedDescLines[2].substring(0, limitedDescLines[2].length - 3) + '...';
            }
            
            const descStartY = titleStartY + (titleLines.length * titleFontSize * 1.2) + 40;
            limitedDescLines.forEach((line, index) => {
                ctx.fillText(line, canvas.width/2, descStartY + (index * descFontSize * 1.3));
            });
            
            // Add "GO IN" button
            const buttonWidth = contentWidth * 0.4;
            const buttonHeight = titleFontSize * 1.8;
            const buttonX = (canvas.width - buttonWidth) / 2;
            const buttonY = contentY + contentHeight - buttonHeight - 40;
            
            // Button background with gradient
            const buttonGradient = ctx.createLinearGradient(buttonX, buttonY, buttonX, buttonY + buttonHeight);
            buttonGradient.addColorStop(0, theme.accent === '#FFD700' ? '#FFD700' : '#FFFFFF');
            buttonGradient.addColorStop(1, theme.accent === '#FFD700' ? '#FFA500' : '#E5E5E5');
            
            ctx.fillStyle = buttonGradient;
            ctx.fillRect(buttonX, buttonY, buttonWidth, buttonHeight);
            
            // Button text
            ctx.fillStyle = theme.gradient[0];
            ctx.font = `bold ${descFontSize * 1.2}px Arial`;
            ctx.textAlign = 'center';
            ctx.fillText('GO IN', canvas.width/2, buttonY + buttonHeight/2);
            
            // Add 3C branding
            ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';
            ctx.font = `${typeFontSize * 0.8}px Arial`;
            ctx.textAlign = 'center';
            ctx.fillText('3C Thread To Success', canvas.width/2, canvas.height - 20);
            
            // Replace page content with the generated image
            document.body.innerHTML = '';
            document.body.style.margin = '0';
            document.body.style.padding = '0';
            document.body.style.display = 'flex';
            document.body.style.justifyContent = 'center';
            document.body.style.alignItems = 'center';
            document.body.style.minHeight = '100vh';
            document.body.style.background = '#000';
            
            canvas.style.maxWidth = '100%';
            canvas.style.maxHeight = '100%';
            canvas.style.objectFit = 'contain';
            
            document.body.appendChild(canvas);
            
            // Set the content type for proper image serving
            document.title = 'Screenshot - ' + title;
        }
        
        // Generate screenshot when page loads
        window.addEventListener('load', generateScreenshot);
    </script>
</body>
</html>
